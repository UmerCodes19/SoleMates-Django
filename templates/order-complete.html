{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block title %}Thanks for Shopping! {% endblock %}

{% block content %}
<div class="breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col">
                <p class="bread"><span><a href="{% url 'index' %}">Home</a></span> / <span>Purchase Complete</span></p>
            </div>
        </div>
    </div>
</div>

<div class="colorlib-product">
    <div class="container">
        <div class="row row-pb-lg">
            <div class="col-sm-10 offset-md-1">
                <div class="process-wrap">
                    <div class="process text-center active">
                        <p><span>01</span></p>
                        <h3>Shopping Cart</h3>
                    </div>
                    <div class="process text-center active">
                        <p><span>02</span></p>
                        <h3>Checkout</h3>
                    </div>
                    <div class="process text-center active">
                        <p><span>03</span></p>
                        <h3>Order Complete</h3>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-sm-10 offset-sm-1 text-center">
                <p class="icon-addcart"><span><i class="icon-check"></i></span></p>
                <h2 class="mb-4">Thank you for purchasing, Your order is complete !</h2>
                
                <!-- Add order summary -->
                <div class="order-summary mt-5">
                    <h4>Order Details</h4>
                    <p><strong>Order Date:</strong> {{ order_date }}</p>
                    <p><strong>Total Amount:</strong> ${{ total_amount|floatformat:2 }}</p>
                    
                    <h5 class="mt-4">Items Purchased</h5>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Price</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in ordered_items %}
                            <tr>
                                <td>{{ item.product.name }}</td>
                                <td>{{ item.quantity }}</td>
                                <td>${{ item.product.price|floatformat:2 }}</td>
                                <td>${{ item.product.price|multiply:item.quantity|floatformat:2 }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
                <p class="mt-4">
                    <a href="{% url 'index' %}" class="btn btn-primary btn-outline-primary">Home</a>
                    <a href="{% url 'men' %}" class="btn btn-primary btn-outline-primary">
                        <i class="icon-shopping-cart"></i> Continue Shopping
                    </a>
<button class="btn btn-success" id="print-ebill-btn"
        data-user-first="{{ request.user.first_name }}"
        data-user-last="{{ request.user.last_name }}"
        data-user-email="{{ request.user.email }}"
        data-order-date="{{ order.date_ordered|date:'F d, Y' }}"
        data-order-total="{{ total_amount }}">
    Print E-Bill
</button>              </p>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script src="{% static 'js/print.js' %}"></script>

{% endblock %}

{% endblock %}