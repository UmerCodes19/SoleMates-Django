

{% extends 'base.html' %}
{% load static %}
{% load store_tags %}
{% block title %}Cart{% endblock %}


{% block content %}
		<div class="breadcrumbs">
			<div class="container">
				<div class="row">
					<div class="col">
						<p class="bread"><span><a href="{% url 'index' %}">Home</a></span> / <span>Shopping Cart</span></p>
					</div>
				</div>
			</div>
		</div>


		<div class="colorlib-product">
			<div class="container">
				<div class="row row-pb-lg">
					<div class="col-md-10 offset-md-1">
						<div class="process-wrap">
							<div class="process text-center active">
								<p><span>01</span></p>
								<h3>Shopping Cart</h3>
							</div>
							<div class="process text-center">
								<p><span>02</span></p>
								<h3>Checkout</h3>
							</div>
							<div class="process text-center">
								<p><span>03</span></p>
								<h3>Order Complete</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Replace the product listing section with this -->
				<div class="row row-pb-lg">
					<div class="col-md-12">
						{% if items %}
						<div class="product-name d-flex">
							<div class="one-forth text-left px-4">
								<span>Product Details</span>
							</div>
							<div class="one-eight text-center">
								<span>Price</span>
							</div>
							<div class="one-eight text-center">
								<span>Quantity</span>
							</div>
							<div class="one-eight text-center">
								<span>Total</span>
							</div>
							<div class="one-eight text-center px-4">
								<span>Remove</span>
							</div>
						</div>
				
						{% for item in items %}
<div class="product-cart d-flex" id="item-{{ item.id }}">
    <div class="one-forth">
        <div class="product-img" style="background-image: url('{{ item.product_image_url}}')"></div>
        <div class="display-tc">
            <h3>{{ item.product_name }}</h3>
        </div>
    </div>
    <div class="one-eight text-center">
        <div class="display-tc">
            <span class="price">${{ item.product_price }}</span>
        </div>
    </div>
    <div class="one-eight text-center">
        <div class="display-tc">
            <form method="post" action="{% url 'update_cart' %}" class="ajax-quantity-form">
                {% csrf_token %}
                <input type="hidden" name="item_id" value="{{ item.id }}">

                <input type="number"
                       name="quantity"
                       value="{{ item.quantity }}"
                       min="1"
                       max="{{ item.stock_quantity }}"
                       data-max="{{ item.stock_quantity }}"
                       class="form-control input-number text-center quantity-input">
            </form>
        </div>
    </div>
    <div class="one-eight text-center">
        <div class="display-tc item-total">
            ${{item.item_total}}
        </div>
    </div>
    <div class="one-eight text-center">
        <div class="display-tc">
            <a href="{% url 'remove_from_cart' item.id %}" class="closed"></a>
        </div>
    </div>
</div>
{% endfor %}


						{% else %}
						<div class="text-center py-5">
							<h3>Your cart is empty</h3>
							<a href="{% url 'women' %}" class="btn btn-primary">Continue Shopping</a>
						</div>
						{% endif %}
					</div>
				</div>
				
				<div class="row row-pb-lg">
    <div class="col-md-12">
        <div class="total-wrap">
            <div class="row">
                <div class="col-sm-8">
                    <!-- Keep coupon form same -->
					 <div class="col-sm-8">
									<form action="#">
										<div class="row form-group">
											<div class="col-sm-9">
												<input type="text" name="quantity" class="form-control input-number" placeholder="Your Coupon Number...">
											</div>
											<div class="col-sm-3">
												<input type="submit" value="Apply Coupon" class="btn btn-primary">
											</div>
										</div>
									</form>
								</div>

                </div>
                <div class="col-sm-4 text-center">
                    <div class="total">
                        <div class="sub">
                            <p><span>Subtotal:</span> <span><strong id="subtotal">${{ subtotal }}</strong></span></p>
                            <p><span>Delivery:</span> <span>$0.00</span></p>
                            <p><span>Discount:</span> <span>$0.00</span></p>
                        </div>
                        <div class="grand-total">
                            <p><span>Total:</span> <span><strong id="total">${{ total }}</strong></span></p>
                        </div>

						
                 <form method="post" action="{% url 'checkout' %}">
    {% csrf_token %}
    <button type="submit">Proceed to Checkout</button>
</form>

                 
                    </div>
                   
                </div>
            </div>
        </div>
    </div>
</div>

				<div class="row">
					
				</div>
				<div class="row">
    <div class="col-sm-8 offset-sm-2 text-center colorlib-heading colorlib-heading-sm">
        <h2>Related Products</h2>
    </div>
</div>
<form method="post" action="{% url 'add_to_cart' %}" id="cart-form">
    {% csrf_token %}
    <div class="row row-pb-md" id="product-container">
        {% for related in related_products %}
        <div class="col-md-3 col-lg-3 mb-4 text-center">
            <div class="product-entry border product-card" data-product-id="{{ related.id }}">
                <a href="{% url 'product_detail' %}?product_id={{ related.id }}" class="prod-img">
                    <img src="{{ related.image.url }}" class="img-fluid" alt="{{ related.name }}">
                </a>
                <div class="desc">
                    <h2><a href="{% url 'product_detail' %}?product_id={{ related.id }}">{{ related.name }}</a></h2>
                    <span class="price">${{ related.price }}</span>
                    <div class="star-rating">
                        {% with ''|center:5 as range %}
                        {% for _ in range %}
                            {% if forloop.counter <= related.details.average_rating|default:0 %}
                                <i class="icon-star-full"></i>
                            {% else %}
                                <i class="icon-star-empty"></i>
                            {% endif %}
                        {% endfor %}
                        {% endwith %}
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center">
            <p>No related products found.</p>
        </div>
        {% endfor %}
    </div>
    <div class="row">
        <div class="col-12 text-right">
            <button type="submit" class="btn btn-primary" id="add-to-cart-btn">
                <i class="icon-shopping-cart"></i> Add to Cart (<span id="selected-count">0</span>)
            </button>
        </div>
    </div>
</form>

			</div>
		</div>


		   {% block extra_js %}
		   <script src="/static/js/ai4.js"></script>
		 
		 
		   {% endblock %}

			{% endblock %}